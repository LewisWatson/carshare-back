language: go
go:
- 1.7.1
- master

# Sudo is required for docker
sudo: required

# Enable docker
services:
  - docker

# In Travis, we need to bind to 127.0.0.1 in order to get a working connection. This environment variable
# tells dockertest to do that.
env:
  - DOCKERTEST_BIND_LOCALHOST=true

install:
  - go get -v github.com/onsi/ginkgo/ginkgo
  - go get -v github.com/onsi/gomega
  - go get -v -t ./...
  - export PATH=$PATH:$HOME/gopath/bin

script:
  - ginkgo -r --randomizeAllSpecs --randomizeSuites --failOnPending --cover --trace --race --compilers=2 . ./resource/ ./storage/mongodb/
  # - docker build -t carshare-back .
  # - docker run -d --name mongo mongo --smallfiles
  # - docker run -d --name carshare-back carshare-back
  # - docker ps | grep -q carshare-back
